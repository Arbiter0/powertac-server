<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">


<h:body>
	<ui:fragment>

		<ui:repeat var="customer" value="#{customers}">
			<script type="text/javascript">
	var bootstrapLineChartData#{customer.customerInfo.id}=null;
	
	var totalkWhLineChartData#{customer.customerInfo.id}=null;
	var productionKWhLineChartData#{customer.customerInfo.id}=null;
	var consumptionKWhLineChartData#{customer.customerInfo.id}=null;
	
	var totalChargeLineChartData#{customer.customerInfo.id}=null;
	var inflowChargeLineChartData#{customer.customerInfo.id}=null;
	var outflowChargeLineChartData#{customer.customerInfo.id}=null;
	
	</script>
		</ui:repeat>


		<p:tabView id="tabCustomers" var="customer" value="#{customers}"
			dynamic="true" cache="true">




			<p:tab title="#{customer.customerInfo.name}">

				<table cellspacing="10">
					<tr>
						<th><h:outputText value="Population:"
								style="font-weight: normal" /></th>
						<th><h:outputText value="Subscriptions:"
								style="font-weight: normal" /></th>
						<th><h:outputText value="Power types:"
								style="font-weight: normal" /></th>
					</tr>
					<tr>
						<td><h:outputText value="#{customer.customerInfo.population}"
								style="font-weight: bold" /></td>
						<td><h:outputText
								value="#{customer.customerModel.customerCount}"
								style="font-weight: bold" /></td>
						<td><ui:repeat var="powerType"
								value="#{customer.customerInfo.powerTypes}">
								<p:graphicImage
									value="/app/resources/resources/images/customers/producer.png"
									height="55px" width="55px" rendered="#{powerType.production}" title="Producer" />

								<p:graphicImage
									value="/app/resources/resources/images/customers/consumer.png"
									height="55px" width="55px" rendered="#{powerType.consumption}" title="Consumer" />
									
								<p:graphicImage
									value="/app/resources/resources/images/customers/storage.png"
									height="55px" width="55px" rendered="#{powerType.storage}" title="Storage" />
							</ui:repeat></td>
					</tr>
				</table>

				<p:tabView dynamic="true" cache="true">

					<p:tab title="Cash">
						<table cellspacing="10">
							<tr>
								<th><h:outputText value="Cash inflow:"
										style="font-weight: normal" /></th>
								<th><h:outputText value="Cash outflow:"
										style="font-weight: normal" /></th>
								<th><h:outputText value="Total:"
										style="font-weight: normal" /></th>
							</tr>
							<tr>
								<td><h:outputText
										value="#{customer.customerModel.cashInflow}"
										style="font-weight: bold">
										<f:convertNumber maxFractionDigits="2" />
									</h:outputText> <h:outputText style="font-weight: bold" value=" &euro;" /></td>
								<td><h:outputText
										value="#{customer.customerModel.cashOutflow}"
										style="font-weight: bold">
										<f:convertNumber maxFractionDigits="2" />
									</h:outputText> <h:outputText style="font-weight: bold" value=" &euro;" /></td>
								<td><h:outputText
										value="#{customer.customerModel.totalCash}"
										style="font-weight: bold">
										<f:convertNumber maxFractionDigits="2" />
									</h:outputText> <h:outputText style="font-weight: bold" value=" &euro;" /></td>
							</tr>
						</table>

						<p:panel
							rendered="#{not empty customer.customerJson.totalChargeLineChartData}">
							<div id="totalChargeLineChartData#{customer.customerInfo.id}"
								style="width: 700px; height: 350px"></div>
							<script type="text/javascript">
				
		 			if (window.totalChargeLineChartData#{customer.customerInfo.id}!=null) {
						window.totalChargeLineChartData#{customer.customerInfo.id}.destroy();					
					}
					window.totalChargeLineChartData#{customer.customerInfo.id} = $.jqplot('totalChargeLineChartData#{customer.customerInfo.id}', [ #{customer.customerJson.totalChargeLineChartDataText},#{customer.customerJson.inflowChargeLineChartDataText},#{customer.customerJson.outflowChargeLineChartDataText} ],{
						title: 'Cash', 
						axesDefaults: {
						        labelRenderer: $.jqplot.CanvasAxisLabelRenderer},
						axes: {
							xaxis: {
						            label: "timeslot",
						            pad: 0},
						    yaxis: {
						            label: "&euro;"}},
						seriesDefaults: {
							showMarker: false
						},
						series:[
								{ label: 'total',      // label to use in the legend for this line.
								       color: '#000000'
								},
								{ label: 'inflow',      // label to use in the legend for this line.
								       color: '#7FFF00'
								},
								{ label: 'outflow',      // label to use in the legend for this line.
								       color: '#D80000'
								}
								
							   ]	,
						legend: {
							     show: true,
							     location: 'se',     // compass direction, nw, n, ne, e, se, s, sw, w.
							     xoffset: 12,        // pixel offset of the legend box from the x (or x2) axis.
							     yoffset: 12,        // pixel offset of the legend box from the y (or y2) axis.
							    },
						
						
						
						}); 
					</script>
						</p:panel>
					</p:tab>

					<p:tab title="Energy">

						<table cellspacing="10">
							<tr>
								<th><h:outputText value="Energy consumption:"
										style="font-weight: normal" /></th>
								<th><h:outputText value="Energy production:"
										style="font-weight: normal" /></th>
								<th><h:outputText value="Total:"
										style="font-weight: normal" /></th>
							</tr>
							<tr>
								<td><h:outputText
										value="#{customer.customerModel.energyConsumption}"
										style="font-weight: bold">
										<f:convertNumber maxFractionDigits="2" />
									</h:outputText> <h:outputText style="font-weight: bold" value=" kWh" /></td>
								<td><h:outputText
										value="#{customer.customerModel.energyProduction}"
										style="font-weight: bold">
										<f:convertNumber maxFractionDigits="2" />
									</h:outputText> <h:outputText style="font-weight: bold" value=" kWh" /></td>
								<td><h:outputText
										value="#{customer.customerModel.totalEnergy}"
										style="font-weight: bold">
										<f:convertNumber maxFractionDigits="2" />
									</h:outputText> <h:outputText style="font-weight: bold" value=" kWh" /></td>
							</tr>
						</table>

						<p:panel
							rendered="#{not empty customer.customerJson.totalkWhLineChartData}">
							<div id="totalkWhLineChartData#{customer.customerInfo.id}"
								style="width: 700px; height: 350px"></div>
							<script type="text/javascript">
				
		 			if (window.totalkWhLineChartData#{customer.customerInfo.id}!=null) {
						window.totalkWhLineChartData#{customer.customerInfo.id}.destroy();					
					}
					window.totalkWhLineChartData#{customer.customerInfo.id} = $.jqplot('totalkWhLineChartData#{customer.customerInfo.id}', [ #{customer.customerJson.totalkWhLineChartData},#{customer.customerJson.productionKWhLineChartData},#{customer.customerJson.consumptionKWhLineChartData} ],{
						title: 'Energy', 
						axesDefaults: {
						        labelRenderer: $.jqplot.CanvasAxisLabelRenderer},
						axes: {
							xaxis: {
						            label: "timeslot",
						            pad: 0},
						    yaxis: {
						            label: "kWh"}},
						seriesDefaults: {
							showMarker: false
						},
						series:[
								{ label: 'total',      // label to use in the legend for this line.
								       color: '#000000'
								},
								{ label: 'production',      // label to use in the legend for this line.
								       color: '#7FFF00'
								},
								{ label: 'consumption',      // label to use in the legend for this line.
								       color: '#D80000'
								}
								
							   ]	,
						legend: {
							     show: true,
							     location: 'se',     // compass direction, nw, n, ne, e, se, s, sw, w.
							     xoffset: 12,        // pixel offset of the legend box from the x (or x2) axis.
							     yoffset: 12,        // pixel offset of the legend box from the y (or y2) axis.
							    },
						
						
						
						}); 
					</script>
						</p:panel>
					</p:tab>

					<p:tab title="Bootstrap">
						<p:panel
							rendered="#{not empty customer.customerJson.bootstrapLineChartData}">
							<div id="bootstrapLineChartData#{customer.customerInfo.id}"
								style="width: 700px; height: 350px"></div>
							<script type="text/javascript">
				
		 			if (window.bootstrapLineChartData#{customer.customerInfo.id}!=null) {
						window.bootstrapLineChartData#{customer.customerInfo.id}.destroy();					
					}
					window.bootstrapLineChartData#{customer.customerInfo.id} = $.jqplot('bootstrapLineChartData#{customer.customerInfo.id}', [ #{customer.customerJson.bootstrapLineChartData}],{
						title: 'Net usage', 
						axesDefaults: {
						        labelRenderer: $.jqplot.CanvasAxisLabelRenderer},
						axes: {
							xaxis: {
						            label: "time",
						            pad: 0},
						    yaxis: {
						            label: "kWh"}},
						seriesDefaults: {
							showMarker: false
						},
						series:[
								{ label: 'usage',      // label to use in the legend for this line.
								       color: '#000000'
								},
																
							   ]	/*,
						legend: {
							     show: true,
							     location: 'se',     // compass direction, nw, n, ne, e, se, s, sw, w.
							     xoffset: 12,        // pixel offset of the legend box from the x (or x2) axis.
							     yoffset: 12,        // pixel offset of the legend box from the y (or y2) axis.
							    },
							   */
						
						
						}); 
					</script>
						</p:panel>

					</p:tab>



				</p:tabView>





			</p:tab>

		</p:tabView>



	</ui:fragment>
</h:body>

</html>

