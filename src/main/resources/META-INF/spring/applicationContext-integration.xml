<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:si="http://www.springframework.org/schema/integration"
       xmlns:si-xml="http://www.springframework.org/schema/integration/xml"
       xmlns:si-jms="http://www.springframework.org/schema/integration/jms"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration-2.0.xsd
   http://www.springframework.org/schema/integration/jms http://www.springframework.org/schema/integration/mail/spring-integration-jms-2.0.xsd
   http://www.springframework.org/schema/integration/xml http://www.springframework.org/schema/integration/mail/spring-integration-xml-2.0.xsd">

    <si-jms:inbound-channel-adapter id="jmsInputChannelAdapter" channel="incomingMessageChannel" destination-name="powertacserverQueue"/>

    <si:channel id="incomingMessageChannel"/>

    <si-xml:unmarshalling-transformer unmarshaller="commandMarshaller" input-channel="incomingMessageChannel"
                                      output-channel="incomingCommandChannel"/>

    <bean id="commandMarshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
        <property name="classesToBeBound">
            <list>
                <value>org.powertac.server.core.command.RevokeTariffCommand</value>
                <!-- <value>org.powertac.server.core.domain.PublishTariffCommand</value> -->
                <!-- <value>org.powertac.server.core.domain.ChangeTariffCommand</value> -->
                <!-- <value>org.powertac.server.core.domain.SubmitShoutCommand</value> -->
                <!-- <value>org.powertac.server.core.domain.DeleteShoutCommand</value> -->
            </list>
        </property>
    </bean>

    <si:channel id="incomingCommandChannel"/>

    <si:payload-type-router input-channel="incomingCommandChannel">
        <si:mapping type="org.powertac.server.core.command.RevokeTariffCommand" channel="revokeTariffChannel"/>
        <!-- <si:mapping type="org.powertac.server.core.domain.Tariff" channel="publishTariff"/> -->
    </si:payload-type-router>

</beans>